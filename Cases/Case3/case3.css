/* ===== Vintage palette to match Case 2 ===== */
:root{
  --bg:#f5ecd7;          /* parchment background */
  --card:#fffbe9;        /* card parchment */
  --ink:#222;            /* dark ink */
  --muted:#4b4638;       /* softer ink */
  --accent:#2f3a6e;      /* link/buttons */
  --accent-2:#d3cfc7;    /* button fill */
  /* --edge:#d4c08a;        /* border */
  /* --edge-2:#bdb76b;      stronger border (notes) */
  --chip:#fff8e1;        /* chip bg */
  --rail:#f9f0d6;        /* board & rails */
}

/* ===== Global ===== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  line-height:1.5;
  font-family:'Special Elite', cursive, Arial, sans-serif;
}
a{color:var(--accent); text-decoration:none}

/* Top bar matches Case 2 card style */
.topbar{
  display:flex;justify-content:space-between;align-items:center;
  padding:16px 18px;
  background:#fdf7e3;
  border-bottom:2px solid var(--edge);
  box-shadow:0 2px 10px #00000014;
}
.topbar h1{
  margin:0;
  font-family:'Creepster', cursive;
  font-size:2.1rem;
  letter-spacing:.5px;
}
.topbar nav a{ font-weight:700 }

/* ===== Screens ===== */
.screen{display:none; padding:18px}
.screen.show{display:block}

/* Intro card styled like Case 2 container */
.intro-card{
  max-width:980px; margin:0 auto;
  background:var(--card);
  border:2px solid var(--edge);
  border-radius:18px;
  padding:24px 26px;
  box-shadow:0 2px 16px #00000022;
}
.intro-card h2{ margin-top:0 }
.intro-card ol{ line-height:1.7 }

/* Buttons feel */
button,
.btn-link{
  background:var(--accent-2);
  color:var(--ink);
  border:none;
  border-radius:8px;
  padding:.7em 1.4em;
  cursor:pointer;
  font-family:inherit;
  box-shadow:1px 1px 4px #00000022;
}
button:hover,.btn-link:hover{ filter:brightness(1.04) }
.btn-link{ display:inline-block; text-decoration:none }

/* ===== Toolbar (Investigation) ===== */
.toolbar{
  display:flex;gap:10px;align-items:center;
  padding:12px;
  background:#fdf7e3;
  border:2px solid var(--edge);
  border-radius:12px;
  box-shadow:0 2px 10px #00000012;
}
.toolbar .spacer{flex:1}
.badge{
  background:#fff3c9;
  border:2px solid var(--edge);
  border-radius:999px;
  padding:4px 10px;
  color:var(--muted);
  font-weight:700;
}

/* ===== Panels & layout ===== */
.layout{display:grid;grid-template-columns:380px 1fr;gap:14px;margin-top:12px;min-height:calc(100vh - 180px)}
.panel{
  background:var(--card);
  border:2px solid var(--edge);
  border-radius:16px;
  padding:14px;
  display:flex;flex-direction:column;min-height:0;overflow:auto;
  box-shadow:0 2px 12px #00000012;
}
.hint{color:var(--muted);font-size:.95rem}

/* ===== Chips (draggables) ===== */
.chips{display:flex;flex-wrap:wrap;gap:8px}
.chips.tall{min-height:460px}
.chip{
  padding:8px 12px;
  border-radius:999px;
  background:var(--chip);
  border:2px solid var(--edge);
  cursor:grab; user-select:none;
  box-shadow:1px 1px 3px #00000018;
}
.chip small{color:var(--muted)}

/* ===== Timeline strip (read-only) ===== */
.timeline-strip{ margin-top:12px }
.timeline-row{ display:flex; align-items:center; gap:8px; margin-bottom:8px }
.timeline-list{
  list-style:none; margin:0; padding:0;
  display:flex; gap:8px; overflow-x:auto; white-space:nowrap;
}
.timeline-list li{
  padding:6px 10px; border:2px solid var(--edge); border-radius:12px;
  background:#fff8e1; flex:0 0 auto;
}

/* ===== Board â€” parchment + dashed thread look ===== */
.board{
  position:relative;
  background:var(--rail);
  border:2px dashed var(--edge);
  border-radius:12px;
  overflow:auto;
  min-height:560px;
  box-shadow: inset 0 0 20px #0000000f;
}
.board-inner{ position:relative; width:1600px; height:1000px }
.card{
  position:absolute; min-width:190px; max-width:270px;
  background:#fdf7e3;
  border:2px solid var(--edge);
  border-radius:12px; padding:10px;
  box-shadow:0 8px 24px rgba(0,0,0,.12);
  cursor:move;
}
.card h4{ margin:0 0 6px }
.card p{ margin:0; color:var(--muted); font-size:.95rem }
.connector{ position:absolute; top:0; left:0; pointer-events:none }

/* ===== Modal (shared) ===== */
.modal{ position:fixed; inset:0; display:none }
.modal.show{ display:block }
.modal__backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.5) }
.modal__dialog{
  position:relative; z-index:1; max-width:750px;
  margin:8vh auto; background:#fdf7e3;
  border:2px solid var(--edge); border-radius:14px; padding:10px;
  max-height:85vh; overflow:auto; box-shadow:0 0 20px rgba(0,0,0,.4)
}
.modal__close{
  position:absolute; top:10px; right:8px;
  background:var(--accent-2); color:var(--ink);
  border:none; border-radius:8px; padding:8px 8px; cursor:pointer
}

/* ===== Map Modal ===== */
.map-modal {
  display:flex; flex-direction:column; gap:8px;
}
.map-head {
  display:flex; align-items:center; gap:12px; justify-content:space-between;
  margin-bottom: 6px;
}
.map-zoom { display:flex; align-items:center; gap:8px }
.map-zoom input[type="range"]{ width:150px }
.map-wrap {
  position:relative;
  border:2px solid var(--edge);
  border-radius:12px;
  overflow:hidden;
  background:#fffbe9;
  height: 450px; 
  max-height: 80vh;
  align-items: center;
}
.map-stage {
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  transform-origin: center center; 
  cursor:grab;
}

.map-stage:active { cursor:grabbing }
.map-bg {
  width: 90%;
  height: 90%;
  object-fit: fill;
  display: block;
  user-select: none;
  pointer-events: none;
}

/* Pins */
.map-pin {
  position:absolute;
  width:18px; height:18px;
  background:#e63946;
  border:2px solid #fff;
  border-radius:50%;
  transform:translate(-50%,-50%);
  box-shadow:0 0 6px rgba(0,0,0,.35);
  cursor:pointer;
  transition:transform .15s ease;
}
.map-pin:hover { transform:translate(-50%,-50%) scale(1.15); }

/* Hint/desc bar */
.map-legend {
  margin-top:6px; padding:8px 10px;
  background:#fff3c9; border:2px solid var(--edge);
  border-radius:10px; color:var(--muted);
}

/* Floating info box on the map */
.map-infobox{
  position:absolute;
  top:0; left:0;
  transform: translate(-50%, -110%); /* center above pin */
  min-width: 220px; max-width: 300px;
  background:#fffbe9;
  border:2px solid var(--edge);
  border-radius:10px;
  padding:10px 12px;
  box-shadow:0 8px 20px rgba(0,0,0,.18);
  color:var(--ink);
  pointer-events:auto;
  z-index:2;
}
.map-infobox h5{
  margin:0 0 6px;
  font-size:1rem;
}
.map-infobox p{
  margin:0 0 6px;
  color:var(--muted);
  font-size:.95rem;
  line-height:1.35;
}
.map-infobox small{
  color:#6b6656;
}
.map-infobox .close{
  position:absolute;
  top:4px; right:6px;
  background:transparent;
  border:none;
  font-size:16px;
  line-height:1;
  cursor:pointer;
  color:#444;
}
.map-infobox::after{
  content:"";
  position:absolute;
  bottom:-8px; left:50%;
  transform:translateX(-50%);
  border-width:8px 8px 0 8px;
  border-style:solid;
  border-color:#fffbe9 transparent transparent transparent;
  filter: drop-shadow(0 -1px 0 var(--edge));
}

/* ===== Forms in submission block ===== */
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:8px}
.grid2 .full{grid-column:1/-1}
.solution input,.solution button{
  width:100%; padding:8px; border-radius:8px;
  border:2px solid var(--edge); background:#fff8e1; color:var(--ink)
}
.result{color:var(--muted);min-height:24px;margin-top:6px}

/* ===== Board/Library two-column variant ===== */
.layout-board{
  display:grid;
  grid-template-columns: 1fr 420px;
  gap:14px; margin-top:12px;
  min-height: calc(100vh - 260px);
}
.right-as-board .board{ position:relative; height: calc(100vh - 340px); overflow:auto }
.right-as-board .board-inner{ position:relative; min-width:1200px; min-height:900px }
.board .connector{ position:absolute; inset:0; pointer-events:none }


/* Responsive */
@media (max-width:1100px){
  .layout,.timeline-layout,.layout-board{ grid-template-columns:1fr }
  .right-as-board .board{ height:60vh }
}
/* ---- Case 2 style parity for Screen 1 ---- */
.case-title{
  font-family:'Creepster', cursive;
  font-size:2.2rem;
  text-align:center;
  margin:8px 0 18px;
}

.intro-card--large{
  max-width: 980px;
  margin: 1.2em auto;
  padding: 24px 26px;
  background: var(--card);
  border: 2px solid var(--edge);
  border-radius: 18px;
  box-shadow: 0 2px 16px #00000022;
}

.detective-intro{ display:flex; align-items:center; gap:14px; margin: 1.2em 0; }
.detective-img{
  width: 72px; height: 72px; border-radius: 50%;
  background: #fff; padding: 6px; border: 2px solid var(--edge);
}

.intro-actions{ display:flex; gap:12px; justify-content:flex-start; margin-top: 30px; }
.next-btn, .exit-btn{
  background: var(--accent-2);
  border: none; border-radius: 8px;
  padding: 0.7em 2em; font-size: 1.05em;
  cursor: pointer; font-family: inherit;
  box-shadow: 1px 1px 4px #00000022; text-decoration:none; color: var(--ink);
}
.next-btn:hover, .exit-btn:hover{ filter: brightness(1.05); }

/* Investigation title row */
.invest-header{
  display:flex; align-items:center; gap:12px;
  padding:12px; background:#fdf7e3;
  border:2px solid var(--edge); border-radius:12px;
  box-shadow:0 2px 10px #00000012; margin-bottom:10px;
}
.invest-title{
  margin:0; flex:1; text-align:center; color:var(--ink);
  font-family:'Creepster', cursive; font-size:1.8rem; letter-spacing:.4px;
}

/* Second toolbar row variant */
.toolbar--secondary{ margin-top:6px; }

/* Board header holding the board actions */
.board-head{
  display:flex; align-items:center; gap:12px; margin-bottom:10px;
}
.board-title{
  margin:0; flex:1; font-family:'Special Elite', cursive; font-size:1.3rem;
}
.board-actions button{ margin-left:8px }

/* Right column heading style */
.library-title{
  margin:0 0 4px 0; font-family:'Special Elite', cursive; font-size:1.2rem;
}

/* ===== Suspect Flip Cards (with images) ===== */
.flip-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:16px;
}

.flip{ perspective:1000px; cursor:pointer; }

.flip-inner{
  position:relative; width:100%; height:360px;
  transition:transform .6s; transform-style:preserve-3d;
}

.flip.flipped .flip-inner{ transform:rotateY(180deg); }

.flip-face{
  position:absolute; inset:0; backface-visibility:hidden;
  background:var(--card); border:2px solid var(--edge); border-radius:14px;
  box-shadow:0 2px 12px #00000022; display:flex; flex-direction:column;
}

.flip-front{ align-items:center; padding:12px; }
.flip-front img{
  width:88%; height:200px; object-fit:fill; border-radius:10px;
  border:2px solid var(--edge); box-shadow:0 2px 6px #00000022; margin-top:4px;
}
.flip-front h4{ margin:10px 0 0; font-size:1.1rem; text-align:center; }

/* small hint arrow bottom-right on the FRONT */
.flip-front .hint-arrow{
  position:absolute; right:10px; bottom:10px;
  background:#eee3c3; border:none; border-radius:8px;
  padding:0.3em 0.5em; box-shadow:1px 1px 3px #00000022; cursor:pointer;
}

/* BACK */
.flip-back{ transform:rotateY(180deg); padding:12px 12px 56px; }
.flip-back h4{ margin:2px 0 6px; font-size:1.05rem; }
.flip-back .body{
  overflow:auto; /* scroll only the text area if needed */
  font-size:.95rem; color:var(--muted);
}
.flip-back .kv{ margin:6px 0; }
.flip-back .kv b{ color:var(--ink); }

/* back buttons pinned to bottom */
.flip-actions{
  position:absolute; right:10px; bottom:10px; display:flex; gap:8px;
}
.flip-btn{
  background:#eee3c3; border:none; border-radius:8px;
  padding:.45em 1em; box-shadow:1px 1px 3px #00000022; cursor:pointer;
}
.flip-btn:hover{ filter:brightness(1.05); }

@media (max-width: 1200px) {
  .modal__dialog {
    max-width: 95vw;
    max-height: 80vh;
  }

  .map-wrap {
    height: 480px; /* slightly smaller on smaller screens */
  }
}
