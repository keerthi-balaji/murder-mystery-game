<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Silence in Server Room 6</title>
  <link rel="stylesheet" href="../../styles.css" />
  <link rel="stylesheet" href="case2.css" />
</head>
<body>
  <div id="game-container">

    <!-- Screen 1: Case intro -->
    <section id="screen-1" class="game-screen">
      <h1 class="case-title">Case 2: The Silence in Server Room 6</h1>
      <p class="case-details">
        A sudden death halts operations at Neuronexus, a tech giant at the forefront of AI innovation. The victim was found inside a restricted server room under suspicious circumstances. A critical breach is suspected. <br><br>
        You, as the assistant to Detective Priya Sen, must help her investigate the digital footprints and uncover the truth.<br><br>
      </p>
      <p class="instructions">
        <strong>Instructions:</strong> Use your database (SQL) and logic skills to help Detective Sen solve the case. Click <b>Next</b> to begin.
      </p>
      <div class="detective-intro">
        <img src="/Images/detective.png" alt="Detective Priya Sen" class="detective-img" />
        <p><b>Detective Priya Sen:</b> "Welcome, partner. Ready to dive into the data?"</p>
      </div>
      <button class="exit-btn" onclick="exitToHome()">Exit</button>
      <button id="next-1" class="next-btn">Next</button>
    </section>

    <!-- Screen 2: Forensic report -->
    <section id="screen-2" class="game-screen hidden">      
      <button class="back-btn" onclick="goBack()">Back</button>
      <div class="detective-dialogue">
        <img src="/Images/detective.png" alt="Detective Priya Sen" class="detective-img" />
        <p><br><br><b>Detective Sen:</b> "Before we start, review the forensic report for clues. Click the button below to open the report." </p>
      </div>
      <button class="exit-btn" onclick="exitToHome()">Exit</button>
      <button class="action-btn" onclick="openForensicReport()">Open Forensic Report</button>      
      <button id="next-2" class="next-btn" disabled>Next</button>
    </section>

    <!-- Forensic Modal -->
    <div id="forensic-modal" class="modal hidden">
      <div class="modal-content">
        <h3>Forensic Report</h3>
        <pre id="forensic-text"></pre>
        <button id="close-forensic" class="action-btn">Close</button>
      </div>
    </div>

    <!-- Screen 3: Database Structure & Instructions -->
<section id="screen-3" class="game-screen hidden">
  <button class="back-btn" onclick="goBack()">Back</button>
  <h2>Database Structure & Instructions</h2>
  <div class="detective-dialogue">        
    <img src="/Images/detective.png" alt="Detective Priya Sen" class="detective-img" />
    <p><b>Detective Sen:</b> "Here's the database you'll be working with. Review the tables, their relationships, and the ER diagram before you begin your investigation."<br>
    </p>
    </div>
    <div class="db-structure">
      <img src="/Images/class diagram.png" alt="Database ER Diagram" class="erd-img" style="max-width:100%;margin:1em 0;">
    </div>
    <div class="detective-dialogue"> 
      <img src="/Images/detective.png" alt="Detective Priya Sen" class="detective-img" />
      <p><b>Detective Sen: </b>"This database captures digital activity and movement within a tech company to support the investigative gameplay. You will analyze employee schedules, messages, server commands, Wi-Fi logs, and access patterns to uncover the truth behind a suspicious incident." </p>
    </div>

    <button class="action-btn" onclick="openDatabaseInfo()">Click to View Table Details</button>

  <div class="db-instructions">
    <br>
    <ul>
      <li>You can use <b>SELECT</b>, <b>JOIN</b>, <b>WHERE</b>, and other standard SQL commands.</li>
      <li>Refer to the ER diagram and table details as needed.</li>
      <li>Click <b>Next</b> when you are ready to start the investigation.</li>
    </ul>
  </div>
  <button class="exit-btn" onclick="exitToHome()">Exit</button>
  <button id="next-3" class="next-btn">Next</button>
  
</section>

    <!-- Screen 4: SQL Investigation -->
    <section id="screen-4" class="game-screen hidden">
      <button class="back-btn" onclick="goBack()">Back</button>
      <button class="action-btn" onclick="openForensicReport()">View Forensic Report </button>
      <button class="action-btn" onclick="openDatabaseInfo()">View Database Info</button>
      <div id="sql-prompts"></div>
      <div class="sql-console">
        <div id="sql-input-fields">
          <label for="sql-query">SQL Query:</label>
          <textarea id="sql-query" rows="3" cols="60"></textarea>
          <button id="run-sql" class="action-btn">Run Query</button>
        </div>
        <div id="sql-result" class="sql-result-box hidden"></div>
      </div>
      <button class="exit-btn" onclick="exitToHome()">Exit</button>
      <button id="next-4" class="next-btn" disabled>Next</button>
    </section>
    
    <!-- Database Info Modal -->
    <div id="dbinfo-modal" class="modal hidden">
    <div class="modal-content">
      <h3>Database Tables & Relationships</h3>
      <pre id="dbinfo-text"></pre>
      <button class="action-btn" onclick="closeDatabaseInfo()">Close</button>
    </div>
    </div>


<!-- Screen 5: Final Answer -->
<section id="screen-5" class="game-screen hidden">
  <div class="detective-dialogue"> 
    <img src="/Images/detective.png" alt="Detective Priya Sen" class="detective-img" />
    <p><b>Detective Sen:</b> "Who do you accuse of murder?"</p>
  </div>
  <select id="final-suspect-answer">
    <option value="">Select a suspect</option>
    <option value="Ava Lin">Ava Lin</option>
    <option value="Jonah Reid">Jonah Reid</option>
    <option value="Malik Awan">Malik Awan</option>
  </select>

  <div class="detective-dialogue"> 
    <img src="/Images/detective.png" alt="Detective Priya Sen" class="detective-img" />
    <p><b>Detective Sen:</b> "Why do you think they did it?"</p>
  </div>
  <select id="final-motive-answer">
    <option value="">Select a motive</option>
    <option value="promotion_jealousy">They were robbed out of a promotion due to Elina's HR Report.</option>
    <option value="accident_coverup">They were covering up an office romance.</option>
    <option value="ai_misuse">They were covering up unauthorized AI training on company servers</option>
    <option value="security_failure">They were acting out of romantic jealousy.</option>    
  </select>

  <button class="back-btn" onclick="goBack()">Back</button>
  <button class="exit-btn" onclick="exitToHome()">Exit</button>
  <button id="submit-answer" class="action-btn hidden">Submit</button>

  <div id="answer-feedback"></div>
  <button id="finish-case" class="next-btn hidden">Close Case</button>
</section>



  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js" defer></script>
  <script src="initDB.js" defer></script>
  <script src="case2.js" defer></script>
</body>
</html>
